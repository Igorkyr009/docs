<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Адмінка</title>
  <style>
    body{font-family:system-ui,sans-serif;margin:0 auto;max-width:820px;padding:16px}
    input,textarea{width:100%;padding:8px;margin:6px 0 12px;border:1px solid #ddd;border-radius:6px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    button{padding:10px 12px;border-radius:8px;border:1px solid #ddd;background:#0ea5e9;color:#fff;cursor:pointer}
    .muted{color:#666;font-size:12px}
  </style>
</head>
<body>
  <h2>Адмін-панель</h2>
  <div class="muted">API Base — URL Render сервісу; Admin Secret — змінна <b>ADMIN_SECRET</b> на Render.</div>
  <div class="row">
    <div><label>API Base</label><input id="api" placeholder="https://tg-shop-webapp.vercel.app/index.html"></div>
    <div><label>Admin Secret</label><input id="sec" placeholder="секрет"></div>
  </div>
  <hr>
  <h3>Створити/оновити товар</h3>
  <label>SKU</label><input id="sku">
  <label>Назва</label><input id="title">
  <div class="row">
    <div><label>Ціна</label><input id="price" type="number"></div>
    <div><label>Валюта</label><input id="cur" value="UAH"></div>
  </div>
  <label>Категорія</label><input id="cat">
  <label>Зображення (URL)</label><input id="img">
  <label>Опис</label><textarea id="desc" rows="4"></textarea>
  <label><input type="checkbox" id="active" checked> Активний</label>
  <button id="save">Зберегти</button>

  <script>
    const api=document.getElementById('api'), sec=document.getElementById('sec');
    api.value=localStorage.getItem('api_base')||''; sec.value=localStorage.getItem('admin_secret')||'';
    api.oninput=()=>localStorage.setItem('api_base',api.value);
    sec.oninput=()=>localStorage.setItem('admin_secret',sec.value);

    document.getElementById('save').onclick=async()=>{
      const base=api.value.trim(), secret=sec.value.trim();
      const body={
        sku:sku.value.trim(), title:title.value.trim(),
        price:parseInt(price.value||'0',10),
        currency:(cur.value||'UAH').trim(),
        category:cat.value.trim(),
        image_url:img.value.trim(),
        description:desc.value.trim(),
        is_active:document.getElementById('active').checked
      };
      if(!base||!secret||!body.sku||!body.title){ alert('Вкажи API, Secret, SKU, Назву'); return; }
      const r=await fetch(`${base}/api/admin/products`,{
        method:'POST',
        headers:{'Content-Type':'application/json','X-Admin-Secret':secret},
        body:JSON.stringify(body)
      });
      if(!r.ok) alert('Помилка: '+await r.text()); else alert('Збережено ✔');
    };
  </script>
</body>
</html>
